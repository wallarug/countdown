<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title> Countdown Clock </title>
	<link rel="shortcut icon" href="../favicon.ico">
	<link rel="stylesheet" href="css/jquery.mobile-1.4.5.min.css">
	<link rel="stylesheet" href="css/listview-grid.css">
	<script src="js/jquery-1.12.4.js"></script>
	<script src="js/jquery.mobile-1.4.5.js"></script>
    
	<!-- Global site tag (gtag.js) - Google Analytics -->    
    <script>
      $( function() {
        $( "#tabs" ).tabs();
      } );
    </script>

</head>
<body>

<div data-role="page" data-theme="b" id="demo-page" class="my-page">

	<div data-role="header">
		<h1>The Clock</h1>
		<!-- <a href="./" data-shadow="false" data-iconshadow="false" data-icon="carat-l" data-iconpos="notext" data-rel="back" data-ajax="false">Back</a> -->
	</div><!-- /header -->
    
    <!-- Please update the image file in img/logo.png for your school.  Also change the background from #000000 (white) to your logo's background. -->
    <!-- <div style="background-color: #FFFFFF;"> -->
        <!-- <img src="img/logo.png" style="margin:auto; text-align: center; display: block" /> -->
    <!-- </div> -->

    <!-- begin body -->
    <div role="main" class="ui-content">

        <div data-role="tabs" id="tabs">
            <div data-role="navbar">
              <ul>
                <li><a href="#clock" data-ajax="false" onclick="onTabClick()">Clock</a></li>
                <li><a href="#timer" data-ajax="false" onclick="onTabClick()">Timer</a></li>
				<li><a href="#exam-1" data-ajax="false" onclick="onTabClick()">Exam 1</a></li>
				<li><a href="#exam-2" data-ajax="false" onclick="onTabClick()">Exam 2</a></li>
                <li><a href="#settings" data-ajax="false">Settings</a></li>
              </ul>
            </div>

            <!-- Clock Tab (default) -->
            <div id="clock">
				<br />
				<p style="text-align:center; ">
					<span style="font-size:36px" id="clock-date"></span> </br />
					<span style="font-size:72px;" id="clock-time"></span>
				</p>
                
            </div>

            <!-- Timer Tab -->
            <div id="timer">
                <br />                
                <!-- Countdown Timer  -->
                <p style="text-align:center; font-size:72px;">
                    <span style="font-size:100px" id="timer-countdown">Not configured.</span> </br />
                </p>
				
				<!-- control buttons -->
                <div style="text-align:center">
                    <a class="ui-shadow ui-btn ui-corner-all ui-btn-inline" type="button" onclick="pauseTimer()" id="pauseButtonTimer" style=" width: 200px;"> Start </a>
                    <a class="ui-shadow ui-btn ui-corner-all ui-btn-inline" type="button" onclick="setTimer()" style=" width: 200px;"> Reset </a>
                </div>
                
            </div>
			
			<div id="exam-1">
				<br />
				
				<!-- Date and Time  -->
				<p style="text-align:center; ">
                    <span style="font-size:42px;" id="exam1-time"></span> </br />
					<span style="font-size:36px" id="exam1-date"></span>
				</p>
                
                <!-- Countdown Timer  -->
                <p style="text-align:center; font-size:72px;">
                    <span style="font-size:100px" id="exam1-countdown">Not configured.</span> </br />
                </p>
                
                <!-- Text or Info  -->
				<div id="exam1-information" style="text-align:center">
                
                </div>
                
                <!-- control buttons -->
                <div style="text-align:center">
                    <a class="ui-shadow ui-btn ui-corner-all ui-btn-inline" type="button" onclick="pauseTimer()" id="pauseButtonExam1" style=" width: 200px;"> Start </a>
                    <a class="ui-shadow ui-btn ui-corner-all ui-btn-inline" type="button" onclick="setTimer()" style=" width: 200px;"> Reset </a>
                </div>
			
			</div>
			
			<div id="exam-2">
				<br />
				
				<!-- Date and Time  -->
				<p style="text-align:center; ">
                    <span style="font-size:42px;" id="exam2-time"></span> </br />
					<span style="font-size:36px" id="exam2-date"></span>
				</p>
                
                <!-- Countdown Timer  -->
                <p style="text-align:center; font-size:72px;">
                    <span style="font-size:100px" id="exam2-countdown">Not configured.</span> </br />
                </p>
                
                <!-- Text or Info  -->
				<div id="exam1-information" style="text-align:center">
                
                </div>
                
                <!-- control buttons -->
                <div style="text-align:center">
                    <a class="ui-shadow ui-btn ui-corner-all ui-btn-inline" type="button" onclick="pauseTimer()" id="pauseButtonExam2" style=" width: 200px;"> Start </a>
                    <a class="ui-shadow ui-btn ui-corner-all ui-btn-inline" type="button" onclick="setTimer()" style=" width: 200px;"> Reset </a>
                </div>
			
			</div>

            <!-- Settings Tab -->
            <div id="settings">
                <form class="form-inline" id="countform1">
                <h3> Timer Settings </h3>
                <div class="ui-field-contain">
					<label for="hours"> Hours: </label>
					<input type="text" name="hours" id="hours" value="1"/>
                    <label for="minutes"> Minutes: </label>
					<input type="text" name="minutes" id="minutes" value="0"/>
                    <label for="seconds"> Seconds: </label>
					<input type="text" name="seconds" id="seconds" value="0"/>
                </div>
				<div class="ui-field-contain">	
					<label for="details"> Details: </label>
					<textarea  type="text" name="details" id="details" rows="8"/>

Reading Time:  m
Writing Time:  h   m
 </textarea>
				</div>
					
					<button type="button" onclick="setTimer()"> Go </button>
				</form>
				
                
                <span id="demo"> </span>
				
				
            </div>

        </div> <!-- End Tabs -->
    </div><!-- /content -->
    
<!-- ~*~  PLEASE INSERT ALL YOUR POPUP CODE BELOW THIS LINE  ~*~ -->

</div><!-- /page -->

	<script>
        // Set the date we're counting down to
        var timeRemaining;
        var pause = false;
		var timerElements = ["timer-countdown", "exam1-countdown", "exam2-countdown"];
		var buttonElements = ["pauseButtonTimer", "pauseButtonExam1", "pauseButtonExam2"];
		var clockTimeElements = ["clock-time", "exam1-time", "exam2-time"];
		var clockDateElements = ["clock-date", "exam1-date", "exam2-date"];
        
        function setTimer(){
            var today = new Date().getTime();
            var hh = document.getElementById("hours").value;
            var mm = document.getElementById("minutes").value;
            var ss = document.getElementById("seconds").value;
            timeRemaining = (hh*3600000) + (mm*60000) + (ss*1000);
            displayInterval();
			parseDetails();
        }

        // Update the count down every 1 second
        var x = setInterval(function() {
          if (pause) {
              // Get today's date and time
            var now = new Date().getTime();

            // Find the distance between now and the count down date
            //var distance = countDownDate - now;
            //var distance = ( now + timeRemaining ) - now;
            var distance = timeRemaining;

            // Time calculations for days, hours, minutes and seconds
            var days = Math.floor(distance / (1000 * 60 * 60 * 24));
            var hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            var minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
            var seconds = Math.floor((distance % (1000 * 60)) / 1000);

            // Display the result
			for(var i=0; i < timerElements.length; i++){
				document.getElementById(timerElements[i]).innerHTML = ('0' + hours).slice(-2) + " h "
				+ ('0' + minutes).slice(-2) + " m " + ('0' + seconds).slice(-2) + " s ";
			}

            timeRemaining = timeRemaining - 1000;

            // If the count down is finished, write some text
            if (distance < 0) {
                clearInterval(x);
				for(var i=0; i < timerElements.length; i++){
					document.getElementById(timerElements[i]).innerHTML = "TIME EXPIRED";
				}
            }
          }
          
        }, 1000);
        
        function displayInterval(){
            // Get today's date and time
            var now = new Date().getTime();

            // Find the distance between now and the count down date
            //var distance = countDownDate - now;
            //var distance = ( now + timeRemaining ) - now;
            var distance = timeRemaining;

            // Time calculations for days, hours, minutes and seconds
            var days = Math.floor(distance / (1000 * 60 * 60 * 24));
            var hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            var minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
            var seconds = Math.floor((distance % (1000 * 60)) / 1000);

            // Display the result
			for(var i=0; i < timerElements.length; i++){
				document.getElementById(timerElements[i]).innerHTML = ('0' + hours).slice(-2) + " h "
				+ ('0' + minutes).slice(-2) + " m " + ('0' + seconds).slice(-2) + " s ";
			}
            
            pause = false;
			for(var i=0; i < buttonElements.length; i++){
				document.getElementById(buttonElements[i]).innerHTML = "Start";
			}
        }
        
        function pauseTimer(){
            if (pause) {
                pause = false;
				for(var i=0; i < buttonElements.length; i++){
					document.getElementById(buttonElements[i]).innerHTML = "Start";
				}
            }
            else {
                pause = true;
				for(var i=0; i < buttonElements.length; i++){
					document.getElementById(buttonElements[i]).innerHTML = "Start";
				}
            }
        }
		
		function startTimeClock() {
		  var today = new Date();
		  var h = today.getHours();
		  var m = today.getMinutes();
		  var s = today.getSeconds();
		  m = checkTime(m);
		  s = checkTime(s);
		  
		  for(var i=0; i < clockTimeElements.length; i++){
				document.getElementById(clockTimeElements[i]).innerHTML =
				h + ":" + m + ":" + s;
		  }
		  
		  var t = setTimeout(startTimeClock, 500);
		}
		
		function startDate() {
			var today = new Date();
			var dd = today.toLocaleDateString();
			
			for(var i=0; i < clockDateElements.length; i++){
				document.getElementById(clockDateElements[i]).innerHTML =
				dd;
			}
		}
		
		function checkTime(i) {
		  if (i < 10) {i = "0" + i};  // add zero in front of numbers < 10
		  return i;
		}
		
		// function for all tab clicks
		function onTabClick(){
			startTimeClock();
			startDate();
		}
        
        function parseDetails(){
            var text = document.getElementById("details").value;
            console.log(text);
            var arr = text.split(";");
            
            var output = "";
            
            if (arr.length == 1) {
                // only one subject (easy case)
                var parts = arr[0].split("\n");
                console.log(parts);
                document.getElementById('information').innerHTML =
                '<p><span style="font-size:72px;">' + parts[0] + '</span> </br> \
                <span style="font-size:53px">' + parts[1] + ' </span></br> \
                <span style="font-size:53px">' + parts[2] + ' </span></br></p>';
            } else {
                // more than 1 subject (let's come back to this later)
                var clssBlock = "";
                var clssDiv = "";
                
                switch(arr.length){
                    case 1:
                        clssDiv = "ui-block-a";
                        break;
                    case 2:
                        clssDiv = "ui-grid-a";
                        break;
                    case 3:
                        clssDiv = "ui-grid-b";
                        break;
                     default:
                        clssDiv = "";
                }
                
                output = '<div class="' + clssDiv + '">';

                for (i=0; i < arr.length; i++){
                    switch(i){
                        case 0:
                            clssBlock = "ui-block-a";
                            break;
                        case 1:
                            clssBlock = "ui-block-b";
                            break;
                        case 2:
                            clssBlock = "ui-block-c";
                            break;
                        default:
                            clssBlock = "ui-block-a";
                    }
                    
                    var parts = arr[i].split("\n");
                    console.log(parts);
                    output += '<div class="' + clssBlock + '"><div class="ui-bar ui-bar-b" style="height:300px"><p>';
                    
                    var firstRow = true;
                    for (j=0; j < parts.length; j++){
                        if(parts[j] == ""){
                            // empty, don't do anything
                            continue;
                        } else {
                            if (firstRow){
                                output += '<span style="font-size:72px;">' + parts[j] + '</span> </br>';
                                firstRow = false;
                            } else {
                                output += '<span style="font-size:53px">' + parts[j] + ' </span></br>';
                            }
                        }
                    }
                    
                    output += "</p></div></div>";
                }
                
                output += '</div>';
                document.getElementById('information').innerHTML = output;
            
            }
        }
	</script>

</body>
</html>
